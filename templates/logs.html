{% extends "base.html" %}

{% block title %}Logs - MacReplay{% endblock %}


{% block content %}
<div id="page-meta" data-page="logs"></div>
<script id="page-data" type="application/json">
{{ {} | tojson }}
</script>
<div class="row">
    <div class="col-12">
        <h2><i class="fas fa-file-alt"></i> System Logs</h2>
        <p class="text-muted">Live log viewer with auto-refresh</p>
    </div>
</div>

<div class="log-controls">
    <div class="row mb-3">
        <div class="col-auto">
            <div class="btn-group" role="group">
                <button type="button" class="btn btn-success" id="btnPlay" onclick="togglePause()" title="Pause/Resume">
                    <i class="fas fa-pause" id="playIcon"></i>
                </button>
                <button type="button" class="btn btn-outline-secondary" onclick="clearDisplay()" title="Clear Display">
                    <i class="fas fa-eraser"></i>
                </button>
                <button type="button" class="btn btn-outline-secondary" onclick="scrollToBottom()" title="Scroll to Bottom">
                    <i class="fas fa-arrow-down"></i>
                </button>
            </div>
        </div>
        <div class="col-auto">
            <select class="form-select" id="logLevelFilter" onchange="filterLogs()">
                <option value="">All Levels</option>
                <option value="ERROR">Errors Only</option>
                <option value="WARNING">Warnings & Errors</option>
                <option value="INFO">Info & Above</option>
                <option value="DEBUG">Debug (All)</option>
            </select>
        </div>
        <div class="col-auto">
            <select class="form-select" id="lineCount" onchange="changeLineCount()">
                <option value="100">Last 100 lines</option>
                <option value="250">Last 250 lines</option>
                <option value="500" selected>Last 500 lines</option>
                <option value="1000">Last 1000 lines</option>
                <option value="all">All lines</option>
            </select>
        </div>
        <div class="col-auto ms-auto">
            <a href="/log" target="_blank" class="btn btn-outline-primary" title="Download Full Log">
                <i class="fas fa-download"></i> Download
            </a>
        </div>
    </div>
</div>

<div class="log-container" id="logContainer">
    <div class="text-center text-muted py-5">
        <i class="fas fa-spinner fa-spin fa-2x"></i>
        <p class="mt-2">Loading logs...</p>
    </div>
</div>

<div class="row mt-2">
    <div class="col-12">
        <small class="text-muted">
            <span id="statusIndicator" class="text-success"><i class="fas fa-circle"></i></span>
            <span id="statusText">Live</span> |
            Lines: <span id="lineCountDisplay">0</span> |
            Last updated: <span id="lastUpdate">-</span>
        </small>
    </div>
</div>
{% endblock %}

{% block scripts %}{% endblock %}
